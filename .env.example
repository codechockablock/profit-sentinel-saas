# ==============================================================================
# PROFIT SENTINEL - COMPLETE ENVIRONMENT CONFIGURATION
# ==============================================================================
#
# SETUP INSTRUCTIONS:
# 1. Copy this file: cp .env.example .env
# 2. Fill in ALL required values (marked with [REQUIRED])
# 3. Fill in recommended values for full functionality
# 4. NEVER commit .env to git (it's in .gitignore)
#
# For production: Use platform secrets (Vercel/AWS), NOT .env files
#
# ==============================================================================


# ==============================================================================
# SECTION 1: AWS CONFIGURATION [REQUIRED]
# ==============================================================================
# Create IAM user: https://console.aws.amazon.com/iam
# Required permissions: S3 (GetObject, PutObject, ListBucket)
#
# Steps to get these:
# 1. Go to AWS Console → IAM → Users → Create User
# 2. Attach policy: AmazonS3FullAccess (or create custom policy)
# 3. Create Access Key → Download credentials
#
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_REGION=us-east-1

# S3 Bucket for file uploads
# Create bucket: https://s3.console.aws.amazon.com/s3
# Enable CORS on bucket for frontend uploads
S3_BUCKET_NAME=your-bucket-name


# ==============================================================================
# SECTION 2: SUPABASE CONFIGURATION [REQUIRED]
# ==============================================================================
# Get these from: https://supabase.com/dashboard → Your Project → Settings → API
#
# Steps:
# 1. Create project at supabase.com
# 2. Go to Project Settings → API
# 3. Copy URL, anon key, and service_role key
#
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.your-anon-key
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.your-service-key

# Next.js public Supabase vars (SAFE for client-side - uses Row Level Security)
# These MUST match the values above
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.your-anon-key


# ==============================================================================
# SECTION 3: XAI / GROK API [RECOMMENDED]
# ==============================================================================
# Get your API key: https://x.ai/api
#
# Powers:
# - AI column mapping for messy POS exports
# - Grok chat assistant
#
# Without this: App uses heuristic fallback (less accurate but functional)
#
# Steps:
# 1. Visit https://x.ai/api
# 2. Sign up / Log in
# 3. Go to API Keys → Create new key
# 4. Copy key (format: xai-...)
#
XAI_API_KEY=xai-your-api-key-here

# Legacy alias (either works, XAI_API_KEY preferred)
# GROK_API_KEY=xai-your-api-key-here

# Anthropic API (Claude) — used for agent reasoning and cold-path analysis
# Get key: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=sk-ant-api03-your-key-here


# ==============================================================================
# SECTION 4: API / NETWORKING CONFIGURATION
# ==============================================================================
# Backend URL - where the FastAPI server is running
#
# LOCAL DEVELOPMENT:
NEXT_PUBLIC_API_URL=http://localhost:8000
#
# PRODUCTION (update to your actual domain):
# NEXT_PUBLIC_API_URL=https://api.profitsentinel.com


# ==============================================================================
# SECTION 5: VERCEL DEPLOYMENT [FOR CI/CD]
# ==============================================================================
# Only needed for GitHub Actions deployment
# Get these from: https://vercel.com/account/tokens
#
# Steps:
# 1. Vercel Dashboard → Settings → Tokens → Create
# 2. Project Settings → General → Copy Project ID and Org ID
#
# Add these as GitHub Repository Secrets (not in .env):
# VERCEL_TOKEN=your-vercel-token
# VERCEL_ORG_ID=your-org-id
# VERCEL_PROJECT_ID=your-project-id


# ==============================================================================
# SECTION 6: EMAIL SERVICE [OPTIONAL - FOR REPORT DELIVERY]
# ==============================================================================
# Choose ONE email provider (Resend recommended for modern API, SendGrid for reliability)
#
# OPTION A: Resend (recommended)
# Get API key: https://resend.com/api-keys
# Free tier: 100 emails/day
RESEND_API_KEY=re_your_api_key_here

# OPTION B: SendGrid
# Get API key: https://app.sendgrid.com/settings/api_keys
# Free tier: 100 emails/day (60 days), then paid
# SENDGRID_API_KEY=SG.your_api_key_here

# Email sender configuration
EMAIL_FROM=reports@profitsentinel.com
EMAIL_FROM_NAME=Profit Sentinel

# ==============================================================================
# SECTION 6b: STRIPE PAYMENTS [REQUIRED FOR BILLING]
# ==============================================================================
# Get keys from: https://dashboard.stripe.com/apikeys
#
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret
STRIPE_PRICE_ID=price_your_price_id

# Redirect URLs after Stripe Checkout
STRIPE_SUCCESS_URL=https://app.profitsentinel.com/dashboard?upgraded=true
STRIPE_CANCEL_URL=https://app.profitsentinel.com/pricing


# ==============================================================================
# SECTION 7: DATA PRIVACY [OPTIONAL]
# ==============================================================================
# Salt for hashing SKUs in anonymized analytics (change in production)
ANONYMIZATION_SALT=your-random-secret-salt-here


# ==============================================================================
# SECTION 8: CORS ALLOWED ORIGINS [OPTIONAL]
# ==============================================================================
# Comma-separated list of allowed frontend origins
# Default includes localhost and common production domains
#
# CORS_ORIGINS=http://localhost:3000,https://profitsentinel.com,https://www.profitsentinel.com


# ==============================================================================
# SECTION 9: VSA EVIDENCE GROUNDING (v4.0)
# ==============================================================================
# Enables evidence-based cause attribution for 0% hallucination
# When enabled, analysis reports include root cause diagnosis
#
USE_VSA_GROUNDING=true
INCLUDE_CAUSE_DIAGNOSIS=true

# Hot path confidence threshold (0.0-1.0) - below this routes to LLM cold path
# VSA_CONFIDENCE_THRESHOLD=0.6

# Ambiguity threshold (0.0-1.0) - above this routes to LLM cold path
# VSA_AMBIGUITY_THRESHOLD=0.5


# ==============================================================================
# SECTION 10: DEVELOPMENT SETTINGS
# ==============================================================================
DEBUG=false
NODE_ENV=development

# Python logging level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO


# ==============================================================================
# SECTION 11: LOCAL DEVELOPMENT SERVICES (OPTIONAL)
# ==============================================================================
# Only needed if using docker-compose local-db or local-storage profiles
# Uncomment and set if using local PostgreSQL/MinIO instead of Supabase/S3
#
# DEV_POSTGRES_USER=sentinel
# DEV_POSTGRES_PASSWORD=your_secure_local_password
# DEV_POSTGRES_DB=profit_sentinel
# DEV_MINIO_USER=minioadmin
# DEV_MINIO_PASSWORD=your_secure_minio_password


# ==============================================================================
# SECTION 12: TERRAFORM / INFRASTRUCTURE [FOR DEPLOYMENT]
# ==============================================================================
# Only needed for infrastructure deployment
# These should be in terraform.tfvars (also gitignored), not here
#
# TF_VAR_acm_certificate_arn=arn:aws:acm:us-east-1:123456789:certificate/abc-123


# ==============================================================================
# QUICK REFERENCE: WHERE TO GET EACH KEY
# ==============================================================================
#
# | Key                    | Where to Get                                      |
# |------------------------|---------------------------------------------------|
# | AWS_ACCESS_KEY_ID      | https://console.aws.amazon.com/iam                |
# | AWS_SECRET_ACCESS_KEY  | https://console.aws.amazon.com/iam                |
# | S3_BUCKET_NAME         | https://s3.console.aws.amazon.com/s3              |
# | SUPABASE_URL           | https://supabase.com/dashboard → Settings → API   |
# | SUPABASE_ANON_KEY      | https://supabase.com/dashboard → Settings → API   |
# | SUPABASE_SERVICE_KEY   | https://supabase.com/dashboard → Settings → API   |
# | XAI_API_KEY            | https://x.ai/api                                  |
# | RESEND_API_KEY         | https://resend.com/api-keys                       |
# | SENDGRID_API_KEY       | https://app.sendgrid.com/settings/api_keys        |
# | VERCEL_TOKEN           | https://vercel.com/account/tokens                 |
# | VERCEL_ORG_ID          | https://vercel.com → Project → Settings → General |
# | VERCEL_PROJECT_ID      | https://vercel.com → Project → Settings → General |
#
# ==============================================================================
